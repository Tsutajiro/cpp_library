<!-- mathjax config similar to math.stackexchange -->

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script type="text/javascript" src="../../../assets/js/balloons.js"></script>

<script type="text/javascript" src="../../../assets/js/copy-button.js"></script>

<p><link rel="stylesheet" href="../../../assets/css/copy-button.css" /></p>
<h1>:warning: ../../string/verify/verify_str_009_manacher.cpp</h1>
<ul>
<li>category: ../../string/verify</li>
</ul>
<p><a href="../../../index.html">Back to top page</a></p>
<h2>Dependencies</h2>
<ul>
<li>:warning: <a href="../str_009_manacher.cpp.html">../../string/str_009_manacher.cpp</a></li>
<li>:warning: <a href="../../structure/strc_008_abst_segtree.cpp.html">../../structure/strc_008_abst_segtree.cpp</a></li>
</ul>
<h2>Code</h2>
<pre><code class="cpp">#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;iostream&gt;
#include &lt;cstdio&gt;
using namespace std;
#include &quot;../str_009_manacher.cpp&quot;
#include &quot;../../structure/strc_008_abst_segtree.cpp&quot;

void tiny_test_str() {
    string s; cin &gt;&gt; s;
    char dummy = '$';

    Manacher&lt;string, char&gt; man(s, dummy);
    man.dump();
}

void tiny_test_int() {
    int N; cin &gt;&gt; N;
    vector&lt;int&gt; v(N);
    for(int i=0; i&lt;N; i++) cin &gt;&gt; v[i];
    int dummy = 0;

    Manacher&lt; vector&lt;int&gt;, int &gt; man(v, dummy);
    man.dump(false);
}

void yuki_464() {
    string s; cin &gt;&gt; s;
    int N = s.size();
    Manacher&lt;string, char&gt; man(s, '$');

    long long int dp[5010][5] = {};
    dp[0][0] = 1;
    for(int i=0; i&lt;N; i++) {
        for(int j=i+1; j&lt;=N; j++) {
            for(int k=0; k&lt;4; k++) {
                if(k != 2) {
                    if(!man.is_palindrome(i, j)) continue;
                    dp[j][k+1] += dp[i][k];
                }
                else {
                    dp[j][k+1] += dp[i][k];
                }
            }
        }
    }
    cout &lt;&lt; dp[N][4] &lt;&lt; endl;
}

void WUPC2019_E() {
    int N, M; cin &gt;&gt; N &gt;&gt; M;
    vector&lt;int&gt; row(N), col(M);
    for(int i=0; i&lt;N; i++) {
        for(int j=0; j&lt;M; j++) {
            char c; cin &gt;&gt; c;
            if(c == '1') row[i]++, col[j]++;
        }
    }

    int dummy = -1, ans = 0;
    Manacher&lt; vector&lt;int&gt;, int &gt; mr(row, dummy), mc(col, dummy);
    for(int i=0; i&lt;N-1; i++) {
        for(int j=0; j&lt;M-1; j++) {
            bool ok = true;
            ok &amp;= mr.is_palindrome(0, i+1);
            ok &amp;= mr.is_palindrome(i+1, N);
            ok &amp;= mc.is_palindrome(0, j+1);
            ok &amp;= mc.is_palindrome(j+1, M);
            if(ok) ans++;
        }
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}

void ukuku09_D() {
    struct SegFunc {
        static int update(int a, int b) { return max(a, b); }
        static int combine(int a, int b) { return max(a, b); }
    };

    int N, Q; cin &gt;&gt; N &gt;&gt; Q;
    string s; cin &gt;&gt; s;
    Manacher&lt; string, char &gt; man(s, '$');
    SegmentTree&lt; int, SegFunc &gt; seg(N, -1);

    for(int i=0; i&lt;N; i++) {
        int rad = man.get_rad(i);
        seg.update(i, rad);
    }

    while(Q--) {
        int ql, qr; cin &gt;&gt; ql &gt;&gt; qr; ql--;

        int ub = (N + 1) / 2 + 1, lb = -1;
        while(ub - lb &gt; 1) {
            int mid = (ub + lb) / 2;
            int l = ql + mid - 1;
            int r = qr - mid + 1;

            bool ok = true;
            if(l &gt;= r) ok = false;
            else {
                int val = seg.query(l, r);
                ok = (val &gt;= mid);
            }

            if(ok) lb = mid;
            else ub = mid;
        }
        int ans = lb * 2 - 1;
        cout &lt;&lt; ans &lt;&lt; endl;
    }
}

int main() {
    // tiny_test_str();
    // tiny_test_int();
    // yuki_464();
    // WUPC2019_E();
    ukuku09_D();
    return 0;
}

</code></pre>

<p><a href="../../../index.html">Back to top page</a></p>