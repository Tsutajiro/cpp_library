<!-- mathjax config similar to math.stackexchange -->

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script type="text/javascript" src="../../assets/js/balloons.js"></script>

<script type="text/javascript" src="../../assets/js/copy-button.js"></script>

<p><link rel="stylesheet" href="../../assets/css/copy-button.css" /></p>
<h1>:warning: ../../math/math_023_matrix_utils_modp.cpp</h1>
<ul>
<li>category: ../../math</li>
</ul>
<p><a href="../../index.html">Back to top page</a></p>
<h2>Required</h2>
<ul>
<li>:warning: <a href="verify/verify_math_023_matrix_utils_modp.cpp.html">../../math/verify/verify_math_023_matrix_utils_modp.cpp</a></li>
</ul>
<h2>Code</h2>
<pre><code class="cpp">// mod p 行列に対する主要な操作
// 実数じゃないので絶対値最大のものを pivot にするとかがいらない

// ガウスの消去法
template &lt;typename mint&gt;
int gaussianEliminationModp(Matrix&lt;mint&gt; &amp;mat, bool ext=false) {
    int N = mat.size(), M = mat[0].size(), rank = 0;
    for(int j=0; j+ext&lt;M; j++) {
        int piv = -1;
        for(int i=rank; i&lt;N; i++) {
            if(mat[i][j] != mint(0)) piv = i, i = N;
        }
        if(piv &lt; 0) continue;
        swap(mat[rank], mat[piv]);
        mint div(mat[rank][j]);
        for(auto &amp;v : mat[rank]) v /= div;
        for(int i=0; i&lt;N; i++) {
            if(i == rank or mat[i][j] == mint(0)) continue;
            mint scale = mat[i][j];
            for(int k=0; k&lt;M; k++) {
                mat[i][k] -= mat[rank][k] * scale;
            }
        }
        rank++;
    }
    return rank;
}

template &lt;typename mint&gt;
vector&lt;mint&gt; linearEquationModp(Matrix&lt;mint&gt; A, vector&lt;mint&gt; b) {
    int N = A.size(), M = A[0].size();
    Matrix&lt;mint&gt; mat(N, M+1);
    for(int i=0; i&lt;N; i++) {
        for(int j=0; j&lt;M+1; j++) {
            mat[i][j] = (j &lt; M ? A[i][j] : b[i]);
        }
    }

    int rank = gaussianEliminationModp(mat, true);
    vector&lt;mint&gt; res(N);
    for(int i=0; i&lt;N; i++) {
        res[i] = mat[i][M];
        if(i &gt;= rank and mat[i][M] != mint(0)) return {};
    }
    return res;
}

template &lt;typename mint&gt;
mint detModp(Matrix&lt;mint&gt; A) {
    int N = A.size(), cnt_swap = 0;
    for(int j=0; j&lt;N; j++) {
        int piv = -1;
        for(int i=j; i&lt;N; i++) {
            if(A[i][j] != mint(0)) piv = i, i = N;
        }
        if(piv &lt; 0) return mint(0);
        cnt_swap += (piv != j);
        swap(A[piv], A[j]);
        for(int i=j+1; i&lt;N; i++) {
            mint scale(A[i][j] / A[j][j]);
            for(int k=0; k&lt;N; k++) {
                A[i][k] -= A[j][k] * scale;
            }
        }
    }

    mint res = (cnt_swap % 2 ? mint(-1) : mint(1));
    for(int i=0; i&lt;N; i++) res *= A[i][i];
    return res;
}

</code></pre>

<p><a href="../../index.html">Back to top page</a></p>