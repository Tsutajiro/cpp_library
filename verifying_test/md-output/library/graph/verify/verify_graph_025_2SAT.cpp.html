<!-- mathjax config similar to math.stackexchange -->

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script type="text/javascript" src="../../../assets/js/balloons.js"></script>

<script type="text/javascript" src="../../../assets/js/copy-button.js"></script>

<p><link rel="stylesheet" href="../../../assets/css/copy-button.css" /></p>
<h1>:warning: ../../graph/verify/verify_graph_025_2SAT.cpp</h1>
<ul>
<li>category: ../../graph/verify</li>
</ul>
<p><a href="../../../index.html">Back to top page</a></p>
<h2>Dependencies</h2>
<ul>
<li>:warning: <a href="../graph_000_basic.cpp.html">../../graph/graph_000_basic.cpp</a></li>
<li>:warning: <a href="../graph_010_scc.cpp.html">../../graph/graph_010_scc.cpp</a></li>
<li>:warning: <a href="../graph_025_2SAT.cpp.html">../../graph/graph_025_2SAT.cpp</a></li>
</ul>
<h2>Code</h2>
<pre><code class="cpp">#include &lt;vector&gt;
#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;utility&gt;
#include &lt;tuple&gt;
#include &lt;algorithm&gt;
using namespace std;
#include &quot;../graph_000_basic.cpp&quot;
#include &quot;../graph_010_scc.cpp&quot;
#include &quot;../graph_025_2SAT.cpp&quot;

void yuki_274() {
    int N, M; scanf(&quot;%d%d&quot;, &amp;N, &amp;M);
    vector&lt;int&gt; L(N), R(N);

    auto flip = [&amp;](int l, int r) {
        return make_pair(M - 1 - r, M - 1 - l);
    };

    auto intersect = [&amp;](int al, int ar, int bl, int br) {
        return !(ar &lt; bl or br &lt; al);
    };

    for(int i=0; i&lt;N; i++) {
        scanf(&quot;%d%d&quot;, &amp;L[i], &amp;R[i]);
    }

    TwoSAT tsat(N);
    for(int i=0; i&lt;N; i++) {
        for(int j=i+1; j&lt;N; j++) {
            for(int bit=0; bit&lt;4; bit++) {
                int al = L[i], ar = R[i];
                int bl = L[j], br = R[j];
                if(bit &amp; 1) tie(al, ar) = flip(al, ar);
                if(bit &amp; 2) tie(bl, br) = flip(bl, br);

                if(intersect(al, ar, bl, br)) {
                    switch(bit) {
                    case 0:
                        // A and B はダメ -&gt; NA or NB
                        tsat.add_NAorNB(i, j);
                        break;
                    case 1:
                        // NA and B はダメ -&gt; A or NB
                        tsat.add_AorNB(i, j);
                        break;
                    case 2:
                        // A and NB はダメ -&gt; NA or B
                        tsat.add_NAorB(i, j);
                        break;
                    case 3:
                        // NA and NB はダメ -&gt; A or B
                        tsat.add_AorB(i, j);
                        break;
                    }
                }
            }
        }
    }
    auto res = tsat.build();
    if(res.size() == N) puts(&quot;YES&quot;);
    else puts(&quot;NO&quot;);
}

void yuki_470() {
    int N; cin &gt;&gt; N;
    vector&lt;string&gt; U(N);
    for(int i=0; i&lt;N; i++) cin &gt;&gt; U[i];

    if(N &gt; 52) {
        cout &lt;&lt; &quot;Impossible&quot; &lt;&lt; endl;
        return;
    }

    TwoSAT tsat(N);
    for(int i=0; i&lt;N; i++) {
        for(int j=i+1; j&lt;N; j++) {
            for(int bit=0; bit&lt;4; bit++) {
                string sa, sb, ta, tb;
                if(bit &amp; 1) sa = U[i].substr(0, 1), sb = U[i].substr(1); // NA, NB
                else sa = U[i].substr(0, 2), sb = U[i].substr(2); // A, B
                if(bit &amp; 2) ta = U[j].substr(0, 1), tb = U[j].substr(1);
                else ta = U[j].substr(0, 2), tb = U[j].substr(2);

                if(sa == ta or sb == tb or sa == tb or sb == ta) {
                    switch(bit) {
                    case 0:
                        tsat.add_NAorNB(i, j);
                        break;
                    case 1:
                        tsat.add_AorNB(i, j);
                        break;
                    case 2:
                        tsat.add_NAorB(i, j);
                        break;
                    case 3:
                        tsat.add_AorB(i, j);
                        break;
                    }
                }
            }
        }
    }

    vector&lt;int&gt; res = tsat.build();
    if(res.empty()) cout &lt;&lt; &quot;Impossible&quot; &lt;&lt; endl;
    else {
        vector&lt;string&gt; pre(N), suf(N);
        for(int i=0; i&lt;N; i++) {
            if(res[i]) pre[i] = U[i].substr(0, 2), suf[i] = U[i].substr(2);
            else pre[i] = U[i].substr(0, 1), suf[i] = U[i].substr(1);
            cout &lt;&lt; pre[i] &lt;&lt; &quot; &quot; &lt;&lt; suf[i] &lt;&lt; endl;
        }
    }
}

int main() {
    // yuki_274();
    yuki_470();
    return 0;
}

</code></pre>

<p><a href="../../../index.html">Back to top page</a></p>